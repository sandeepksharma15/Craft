Please review and optimize this code. Please add summary comments as well. Thanks

Write all possible unit test cases for this code using xunit and fluentassertions. Use Theory based tests. Thanks

Write all possible unit test cases for this code using xunit and fluentassertions. Thanks